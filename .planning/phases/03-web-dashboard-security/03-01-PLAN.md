---
phase: 03
plan: 01
type: autonomous
wave: 1
requirements: [WEB-01, WEB-02, SEC-02]
---

# 03-01: Establish Chainlit environment with Auth

The goal is to establish the Chainlit environment and secure it with password-based authentication.

## Tasks

### 1. Setup Chainlit with Auth in src/web_ui.py (type="auto")
- Install `chainlit` dependency if missing.
- Create `src/web_ui.py`.
- Configure Chainlit authentication using `CHAINLIT_AUTH_SECRET`.
- Implement a basic authentication callback.

### 2. Implement basic chat adapter (type="auto")
- Reuse `src/agent/core.py` (ironclaw_agent).
- Reuse `src/database/manager.py` (DatabaseManager) for persistence.
- Implement `on_chat_start` to load history.
- Implement `on_message` to run the agent and handle `CodeExecutionRequest`.
- Handle HITL (Human In The Loop) approval via Chainlit's `AskUserMessage` or similar UI elements.

### 3. Environment variable configuration (type="auto")
- Add `CHAINLIT_AUTH_SECRET` and `CHAINLIT_PASSWORD` to `.env`.

## Success Criteria
1. `src/web_ui.py` exists and starts without errors.
2. Accessing the UI requires a password.
3. User can chat with the agent and it maintains history (reusing Phase 2 persistence).
4. HITL requests are presented in the UI.
